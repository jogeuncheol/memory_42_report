# 학습 레포트 40일차 2021-02-28 (일)

## 1. 학습 날짜
> ### 2021-02-28 (일)

## 2. 학습 시간
> ### 17:00 ~ 18:40 (집)

## 3. 학습 범위 및 주제
### | ft_printf에서 구조체 사용하기 |

## 4. 동료 학습 방법
- 해당 없음

## 5. 학습 목표
- ft_printf의 플래그를 구조체로 사용하기

## 6. 상세 학습 내용
- **실제 코딩 시간** 1시간
- **참고한 내용** 

### ft_printf 너비, 정밀도, 플래그 구조체
ft_printf 과제를 끝내고 동료 평가를 받으며 계속 받았던 질문이 너비나 정밀도, 플래그 설정을 보통 구조체를 사용해서 작성하는데 배열로 사용한 이유에 대해서이다. 이 질문을 받고 대답으로 `int mf`, `int zf`, `int width`, `int p_width` 등 코드를 작성할 때 하나씩 변수를 늘려가며 문자열을 읽고 설정을 해주었는데, 이렇게 하기보다 그냥 배열을 만들고 하나씩 기능을 늘려갈 때 마다 배열 크기를 바꿔주면 편해서 배열로 작성을 하게 되었다. 라고 답변을 해드렸었다. 배열을 이용했던 이유는 딱히 없었지만 간단하게 바로 테스트가 가능했기 때문에 배열을 사용했었다.

배열을 사용했을때 단점으로는 이미 배열의 값이 어떤 것을 가르키는지 알고 있다면 문제되지 않지만 3자에게 코드를 설명하려하면 이 배열에 데이터가 어떤 순서로 저장되는지 설명할 필요가 있다. 배열의 요소마다 이름을 붙일 수 없기 때문이다. 주석으로 표기하는 것도 하나의 방법이지만, 가이드가 필요한 점에서 단점이 사라질 수는 없다고 본다. 구조체를 사용하면 위의 문제점을 해결할 수 있다.

구조체를 사용하면 `flag.minus, flag.zero, flag.width, flag.star` 등 구조체의 멤버변수의 이름으로 사용이 가능하기 때문에 명확하고 구조체가 어떤 작동을 위해 사용되는지만 알면 누구나 이해하기 쉬운 코드가 될 것이다.

### 구조체
```c
typedef struct flag
{
    int minus;
    int zero;
    int star;
    int width;
    int dot;
    int p_minus;
    int p_zero;
    int p_star;
    int p_width;
    int char_string;
} flag;
```
flag 구조체는 `-`, `0`, `*` 등 플래그가 존재하는지에 대해 0 또는 1 또는 너비와 정밀도 값으로 세팅이 가능할 것이다.

### 구조체 초기화
```c
void init_flag(char *buff, va_list ap, flag *set)
{
    ft_memset(set, 0, sizeof(set));
    ft_init_flag_width(buff, ap, set);
}
...
flag set;
init_flag(buff, ap, &set);
...
```
배열 초기화에 사용했던 함수 init_signal 함수를 init_flag로 바꾸고 flag 구조체 변수 set을 하나 만든 후 init 함수에 주소값으로 넘겨주게 되면 해당 함수 내에서 memset 함수를 사용해 구조체를 0으로 초기화 가능할 것이다. 이후 ft_init_flag_width 함수를 호출해 buff 문자열에서 -, 0, * 플래그 등을 확인하고 값을 설정하는 것이 가능할 것이다.

### set_width
```c
while (buff[i] != '\0' && buff[i] != '.')
{
    if (buff[i] == '-')
        set.minus = 1;
    else if (buff[i] == '0')
        set.zero = 1;
    else if (buff[i] == '*')
    {
        set.star = 1;
        ft_asterisk(set, ap, set.dot);
    }
    else if (buff[i] >= '1' && buff[i] <= '9')
    {
        set.width = 0;
        while (buff[i] >= '0' && buff[i] <= '9')
            set.width = (set.width * 10) + (buff[i++] - '0');
        continue ;
    }
    i++;
}
if (buff[i] == '.')
    ft_init_precision(...);
```
앞서 만든 구조체를 이용해 플래그들과 width를 설정하는 함수를 작성해 보았다. 과제를 진행하며 작성했던 set_width 함수에서 배열을 사용했던 부분만 구조체의 멤버변수들로 바꾸어 주었다.

## 7. 학습 내용에 대한 개인적인 총평
구조체를 사용하면 코드를 좀더 읽기 쉽고 누구나 알아보기 쉬울것이다. 배열을 사용했던 부분을 구조체로 바꿔보면서 확실히 코드 작성도 편했다. 배열을 사용해서 작성 할 떄는 배열의 인덱스로 구분해서 작성하다보니 실수로 잘못 적거나 했을 떄가 있었는데 구조체를 사용하면 필요한 부분에 멤버 변수를 사용하면 되니 직관적으로 사용할 수 있어서 좋았다. 구조체를 가능하면 자주 사용해 보면서 여러곳에 활용해보는 것을 해봐야겠다.

## 8. 다음 학습 계획
- exam 대비 또는 cub3D 공부