# 학습 레포트 47일차 2021-03-11 (목)

## 1. 학습 날짜
> ### 2021-03-11 (목)

## 2. 학습 시간
> ### 22:00 ~ 24:00 (집)

## 3. 학습 범위 및 주제
### | cub3D, miniRT |

## 4. 동료 학습 방법
- 해당 없음

## 5. 학습 목표
- cub3D와 miniRT 과제에 대한 정리

## 6. 상세 학습 내용
- **실제 코딩 시간** 0시간
- **참고한 내용** 없음

### cub3D 과제

cub3D 과제는 ray casting 기법을 사용해 2D 를 3D로 보여지게 하는 그래픽 과제이다. 과제를 진행하기 위해 필요한 지식으로 먼저 ray_casting 에 대한 정리가 되어야 한다고 생각한다. 이후 광선 투사를 위한 알고리즘으로 DDA 와 Bresenham 알고리즘에 대해 알아보면 된다. 빠른 속도로 선을 그릴 수 있는 알고리즘에 대해 알아 본 후 map 의 한 지점에서 여러방향으로 직선을 그렸을 때 좌표 값에 따라 직선그리기를 중지하거나 계속 찾아 나아가도록 하면 된다. 이러한 방법으로 좌표에 해당하는 값에 따라 벽을 세우거나 더 멀리 있는 벽을 표현 하는 것이 ray casting 이라고 이해 하였다.

ray casting 을 사용하여 2D를 3D로 변환하여 그려 다른 그래픽을 사용하지 않고 연산만 사용해 게임과 같은 그래픽을 시뮬레이션 할 수 있게 된다. ray casting은 이러한 그래픽 처리를 바탕으로 만들 수 도 있지만, 투사체에 대해 ray casting 을 사용해 명중을 표현하는 방법처럼 하나의 기법으로 사용도 가능하다. ray casting의 기본은 광선을 투사해 원하는 방법으로 프로그램에서 처리를 하는 것이기 때문에 기본은 매우 간단하다고 생각한다.

### cub3D 첫 느낌

cub3D 과제는 42 슬랙을 통해 처음 접했고, 동영상으로 처음 작동하는 것을 보았었다. 처음 보고 든 생각은 windows 운영체제의 화면 보호기로 설정 가능했던 미로가 생각났다. 아마 ray casting을 사용해 만든 것이 아닌가 생각이 든다. 그리고 둠이 가장 먼저 생각이 들었다. 맥북 프로 터치바모델이 처음 출시 되었을 때, 터치바 영역에 둠을 실행시키는 것을 인터넷에서 본 적이 있었고, 공학용 계산기에서도 둠을 돌리는 것을 본 적이 있었다. 어떻게 만들어졌길래 가능했는지 몰랐는데 cub3D 과제를 만나고 pdf를 읽으며 울펜슈타인3D를 알게 되었고, 둠이 어떻게 실행 가능했는지에 대해서도 알 수 있었다. ray casting 을 이용해 3D 화면을 그려내도록 만든 게임은 그 예전 속도가 지금처럼 빠르지 않던 시기에 그래픽 엔진없이 구동 가능한 빠른 속도의 연산처리 기법이었다.


### miniRT 과제
cub3D를 처음 보고 꼭 해보고 싶다고 느꼈고, 동시에 miniRT 과제에 대해서도 알 수 있었는데, miniRT 과제는 ray tracing 을 만드는 과제로 최근 몇년간 nvidia의 그래픽카드에서 주력으로 밀고있는 RT 코어에 대한것과 RTX ON 이라 하는 것에 대해서 다시 떠올리게 되었었다. ray casting이 편도 도로라면 ray tracing 은 왕복 도로이다. 레이 트레이싱은 광선을 투사해 반사된 광선을 계속 추적하고 다른 물체에서 다시 반사된 광선을 또 추적하고를 반복하며 현실 세계의 자연스러운 빛을 컴퓨터 연산으로 구현하는 과제이다.

miniRT 과제도 해보고 싶은 과제이고, 42 과정중 평가는 cub3D 또는 miniRT 둘 중 하나만 가능하지만 서브젝트는 언제나 읽어볼 수 있고, 42의 모든 카뎃분들이 계시는 한 언제나 평가를 스스로 요청할 수 있지 않을까 생각이 들어 42과정이 끝나기 전에 한번 꼭 해보고 싶은 과제라고 생각한다. 지금은 게임처럼 만들 수 있는 cub3D를 더 하고 싶어 먼저 cub3D과제를 진행 하지만 꼭 도전해 보아야 겠다고 생각한다.


### 게임에서 ray tracing
miniRT 과제를 보고 왜 레이트레이싱 옵션이 지금까지 적당한 처리에서 머물러 있었을지 알 수 있었다. 아마 대부분의 게임엔진에는 레이 트레이싱 효과가 있을 것이라 생각한다. 그림자를 그리고 수면에 비친 모습을 그려낸다거나 하는 방법에 사용되었지 않나 생각을 하기도 하고 반사이미지의 경우 손쉽게 배경맵을 사용하는 경우가 많을것으로 예상하고 있긴 하지만 사용되지 않지는 않았을 것이다. 고가의 그래픽카드, 좋은 성능의 그래픽 카드가 이제 나오기 시작하고 왜 이제서야 게임에 적용하고 또 고 성능의 pc 가 준비되어야 게임에서 레이트레이싱 옵션을 켜고 즐길 수 있을지 조금이나마 알게 된 것 같다.

왜냐하면 광선 추적을 어느 시점까지 멈추지 않고 계속 해야 자연스러운 반사 이미지를 생성할 수 있을지, 게임 성능의 저하 없이 구현해야 하기 때문에 지금까지의 게임에서는 성능의 한계와 같이 적용이 힘들었던 것 같다. 게임에서 반사 이미지를 그려내지 못했던 것은 아니다. 5년전 출시된 온라인 mmorpg 게임 검은사막에서 물 웅덩이로 비친 캐릭터의 모습이나 건물이 표현되는 것을 보면 레이트레이싱이 사용되지 않았던 것은 아니다. 하지만 반사 이미지를 볼 수 있는 것은 카메라의 제한된 각도와 비칠 이미지의 카메라와의 거리에 제한이 있음은 분명했다. 물 웅덩이 위에서 카메라를 수직으로 보게 하면 실제로는 하늘의 구름이 보인다거나 가까이에 있는 벽의 표면이 비쳐 보여야 하는 데, 게임에서는 카메라를 수직으로 두었을 때 대부분 반사 처리가 되지 않는것을 경험으로 알 수 있었다. 각도를 점점 수직으로 할 수록 반사된 이미지의 경계가 존재하는 것도 가능한 성능을 내어야 하기 때문이라고 생각한다. 또한 이 게임이 mmo 게임인 것을 감안한다면 오롯이 성능에 집중 할 수 있는 싱글 게임의 경우에는 더 좋은 반사이미지를 얻을 수 도 있겠지만 아직까지는 성능의 문제가 있었을 것 같다. 이제는 gpu와 cpu, 메모리 속도같은 pc의 성능이 향상되었으므로 앞으로 레이트레이싱효과는 빠질 수 없는 효과로 자리잡을 것이라 생각한다.

### cub3D 과제를 위한 준비

cub3D 과제를 하기 위해 ray casting에 대한 공부와 직선그리기 알고리즘 등을 익히고 나면 42에서 주어지는 minilibx 라이브러리를 사용해 보고 익혀야 한다. minilibx 는 과제를 수행하는데 최소한으로 제공하는 그래픽 라이브러리라고 생각한다. openGL에서 사용할 수 있는 함수들 중 윈도우 그리기, 픽셀 컨트롤, 이미지 컨트롤 부분만 빼고 전부 제거된 라이브러리라는 생각이 들었다. 필요한 부분은 직접 구현해야 한다.

mlx에서 기본기를 익히고나면 본격적으로 cub3D 과제를 진행하기 위해 그래픽도구(mlx)와 알고리즘(DDA || Besenham)을 응용해 2D 맵을 3D로 그려낼 방법을 연구 하면된다. 해당 과정에서 방향 조정과 시점이동을 위해 벡터를 공부하거나 수학적인 부분도 필요하다고 한다. 이제 화면에 그림을 그리고, 움직임을 구현했다면 다음은 이미지를 띄우고, 이제 맵을 파싱할 코드를 추가하면 된다고 한다.

과제 진행을 위해 지금까지 libft, gnl, ft_printf, piscine rush등을 경험했다고 생각이 든다. cub3D는 하나의 프로젝트로 지금까지는 기능 구현을 위주로 함수를 만들고 평가를 받아 왔지만 cub3D, miniRT는 하나의 프로젝트로서 본과정의 첫 번째 고비라고 생각한다. 이것을 즐겁게 공부하며 다음 단계로 넘어가는 것이 42에서 기대하는 것이 아닐까 혼자 생각을 해 본다.

## 7. 학습 내용에 대한 개인적인 총평
cub3D 와 miniRT 과제를 읽어보고 떠오른 생각이나 찾아보 것을 토대로 작성을 해 보았다. cub3D는 게임을 만드는 프로젝트, miniRT는 빛반사 시뮬레이터 프로젝트 라는 느낌이 들었고, 평소 게임을 즐기면서 경험한 빛 반사에 대한 것과 고전 게임들에 대한 경험들이 생각났다. 이번 과제를 즐기면서 해결하고 나아가면 내가 원하는 목표도 하나 이룰 수 있을 것 같은 희망이 보인다. 게임을 한번 꼭 만들어 보고 싶었는데, 유니티나 다른 게임 엔진의 도움을 받지 않고 만들어 보고 싶었는데 가능할 지도 모른다는 생각이 들었고, 관련 자료들을 찾아보면서 정리하고 cub3D 과제를 잘 마칠 수 있도록 해보아야 겠다.

## 8. 다음 학습 계획
- cub3D 과제 공부