# 학습 레포트 52일차 2021-03-16 (화)

## 1. 학습 날짜
> ### 2021-03-16 (화)

## 2. 학습 시간
> ### 18:00 ~ 24:00 (집)

## 3. 학습 범위 및 주제
### | cub3D 방향 ray 회전 |

## 4. 동료 학습 방법
- 해당 없음

## 5. 학습 목표
- cub3D의 방향 ray 회전 시키기

## 6. 상세 학습 내용
- **실제 코딩 시간** 3시간
- **참고한 내용** 없음

### 회전
방향 ray를 회전시키기 위해 기준 좌표를 새로 찍고 직선을 표현 해야 한다. 먼저 좌표평면에서 기준좌표 (1, 0)을 90도 회전시킨 (0, 1)을 찍을 수 있어야 했다.
```
x2 = r * cos(a)
y2 = r * sin(a)
```
r은 반지름 a 는 회전 각도이다. x1, y1은 회전하기 전 좌표이고 이 좌표에 cos, sin 값을 더해주면 움직인 좌표를 얻을 수 있다. cos(90) 은 0, sin(90) 은 1이므로 (0, 1) 이 된다. 회전 각도가 45도 라면 cos(45) = 루트2 / 2, sin(45) = 루트2 / 2 가 될것이다.\
위 식은 기준 좌표를 가지고 현재 위치부터 반지름이 r인 가상의 원을 따라 회전한 방향 좌표를 표시 할 수 있다.

### Q, E 로 회전 시키기

```c
#define KEY_Q 12
#define KEY_E 14

int key_press(int keycode, t_param *param)
{
    static float seta;
    static int i;
...
    else if (keycode == KEY_Q)
    {
        i--;
        seta = i * M_PI / 180 * 5;
        param->xy.x2 = 50 * cos(seta);
        param->xy.y2 = 50 * sin(seta);
    }
    else if (keycode == KEY_E)
    {
        i++;
        seta = i * M_PI / 180 * 5;
        param->xy.x2 = 50 * cos(seta);
        param->xy.y2 = 50 * sin(seta);
    }
...
}
```
seta는 radian, i는 degree 로 사용될 변수이다.\
키보드의 Q 를 누르면 반시계 방향으로, E를 누르면 시계방향으로 방향ray가 회전을 하게 된다.\
좌표평면에서 반시계방향으로 회전을 하게 되면, x값과 y이 줄어들다 늘어나기를 반복하게 되는데 프로그램 실행의 평면은 오른쪽으로 x값의 증가, 아래로 y값의 증가로 좌표평면과 y = x 반전이 되어있다고 생각하면 된다. 따라서 반시계 방향으로 각도를 줄여주고 시계방향으로 각도를 늘려 주었다.

seta에 5를 곱한 이유는 회전 각도를 5도씩 늘려 테스트 용으로 넣어두었다.\
반지름은 50으로 임의로 설정했다.

## 7. 학습 내용에 대한 개인적인 총평
회전 각도를 구하는 식은 math.h 헤더에 정의된 M_PI 값을 사용해서 쉽게 구할 수 있었다. cos, sin등 삼각함수도 사용할 수 있어서 다른 계산을 할 필요가 없었다. 하지만 현재 위치부터 방향좌표를 회전시키기 위해 식을 도출하는 과정이 오래 걸렸고, DDA 를 사용해 바라보는 방향 ray를 함께 그리기 위해 식을 세우는 게 어려웠다.\
현재 수정된 DDA로는 벽을 만나면 ray를 그만 전진하고 좌표까지의 거리를 계산할 때 사용 할 DDA와 다를 것 같다는 느낌이 들었다. 아직 ray가 벽 좌표와 만나는 코드를 작성하지 못했지만 지금은 그냥 계속 작성을 할 뿐이다.

## 8. 다음 학습 계획
- cub3D 공부